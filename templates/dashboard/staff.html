<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weekly Schedule - Timeline View</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f6f9;
            margin: 0;
            padding: 2rem;
        }

        h2 {
            text-align: center;
            margin-bottom: 2rem;
        }

        .schedule {
            max-width: 900px;
            margin: 0 auto;
        }

        .day-row {
            margin-bottom: 1.5rem;
        }

        .day-label {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .timeline {
            position: relative;
            height: 40px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }

        .shift-block {
            position: absolute;
            height: 100%;
            border-radius: 5px;
            color: white;
            font-size: 0.8rem;
            padding: 0.2rem 0.5rem;
            box-sizing: border-box;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .morning { background-color: #28a745; }
        .afternoon { background-color: #ffc107; color: black; }
        .evening { background-color: #dc3545; }
        .night { background-color: #6f42c1; }
        .off { font-style: italic; color: #888; }

        .timeline-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: #666;
            margin-top: 0.25rem;
        }
    </style>
</head>
<body>

<h2>Weekly Schedule for {{ user.name }}</h2>

<div class="schedule" id="schedule-container"></div>

<script>
    const schedule = {
        "Monday": [
            { type: "morning", start: "08:00", end: "12:00" },
            { type: "afternoon", start: "13:00", end: "17:00" }
        ],
        "Tuesday": [
            { type: "evening", start: "17:30", end: "21:30" }
        ],
        "Wednesday": [],
        "Thursday": [
            { type: "morning", start: "09:00", end: "12:00" }
        ],
        "Friday": [
            { type: "night", start: "22:00", end: "02:00" }  // Over midnight
        ],
        "Saturday": [],
        "Sunday": []
    };

    const scheduleContainer = document.getElementById('schedule-container');

    const timeToPercent = (timeStr) => {
        const [hours, minutes] = timeStr.split(':').map(Number);
        return ((hours + minutes / 60) / 24) * 100;
    };

    for (const [day, shifts] of Object.entries(schedule)) {
        const dayRow = document.createElement('div');
        dayRow.className = 'day-row';

        const label = document.createElement('div');
        label.className = 'day-label';
        label.textContent = day;
        dayRow.appendChild(label);

        const timeline = document.createElement('div');
        timeline.className = 'timeline';

        if (shifts.length === 0) {
            const offLabel = document.createElement('div');
            offLabel.className = 'off';
            offLabel.style.padding = '10px';
            offLabel.textContent = 'Off';
            timeline.appendChild(offLabel);
        } else {
            shifts.forEach(shift => {
                const startPercent = timeToPercent(shift.start);
                const endPercent = timeToPercent(shift.end);
                let widthPercent = endPercent - startPercent;

                // Handle shift going past midnight
                if (widthPercent < 0) {
                    widthPercent += 100;
                }

                const block = document.createElement('div');
                block.className = `shift-block ${shift.type}`;
                block.style.left = `${startPercent}%`;
                block.style.width = `${widthPercent}%`;
                block.textContent = `${shift.type.charAt(0).toUpperCase() + shift.type.slice(1)} (${shift.start} - ${shift.end})`;

                timeline.appendChild(block);
            });
        }

        dayRow.appendChild(timeline);

        const timeLabels = document.createElement('div');
        timeLabels.className = 'timeline-labels';
        timeLabels.innerHTML = `
            <span>00:00</span>
            <span>06:00</span>
            <span>12:00</span>
            <span>18:00</span>
            <span>24:00</span>
        `;

        dayRow.appendChild(timeLabels);
        scheduleContainer.appendChild(dayRow);
    }
</script>

</body>
</html>
